(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03c8d398"],{4228:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.section?i("div",[i("div",{staticClass:"mb-base",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[i("div",[i("div",{staticStyle:{display:"flex","align-items":"center",cursor:"pointer"}},[i("feather-icon",{staticClass:"mr-2",staticStyle:{width:"18px","margin-bottom":"2px"},attrs:{icon:"ArrowLeftIcon"},on:{click:function(e){return t.$router.go(-1)}}}),i("h3",{staticClass:"mb-1",staticStyle:{"padding-left":"10px","border-left":"1px solid silver"}},[t._v("Модули секции")])],1)]),i("vs-button",{attrs:{color:"primary","icon-pack":"feather",icon:"icon-plus"},on:{click:function(e){t.isPrompt=!0}}},[t._v("Добавить модуль")])],1),i("vs-divider",{staticClass:"section-title mb-5",attrs:{position:"left","border-style":"dashed"}},[i("div",{staticStyle:{display:"flex","align-items":"center",padding:"0"}},[i("feather-icon",{staticClass:"mr-2",attrs:{icon:"GridIcon"}}),i("h5",[t._v(t._s(t.section.name))])],1)]),i("div",{staticClass:"vx-row"},t._l(t.section.modules,function(e){return i("div",{staticClass:"vx-col w-full lg:w-1/4 md:w-1/2 mb-2"},[i("vs-card",[i("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[i("div",{staticClass:"p-2",staticStyle:{display:"flex","align-items":"center","white-space":"nowrap",overflow:"hidden"}},[i("feather-icon",{staticClass:"mr-4",attrs:{icon:"GitCommitIcon"}}),i("div",[i("h5",{staticClass:"mb-1"},[t._v(t._s(e.name))]),t._v("\n                            ID: "+t._s(e.device_id)+"\n                        ")])],1),i("div",{staticClass:"p-2",staticStyle:{display:"flex","align-items":"center"}},[i("vs-button",{staticClass:"mx-2",attrs:{size:"small",color:"primary",type:"border","icon-pack":"feather",icon:"icon-edit-2"},on:{click:function(i){return t.edit(e)}}}),i("vs-button",{attrs:{size:"small",color:"danger",type:"border","icon-pack":"feather",icon:"icon-trash-2"},on:{click:function(i){return t.remove(e)}}})],1)])])],1)}),0),i("vs-prompt",{attrs:{title:t.current.id?"Редакировать модуль":"Новый модуль","accept-text":"Сохранить","cancel-text":"Отменить",active:t.isPrompt},on:{cancel:t.cancel,accept:t.save,close:t.cancel,"update:active":function(e){t.isPrompt=e}}},[i("div",{staticClass:"con-exemple-prompt"},[i("span",[t._v("Введите название")]),i("vs-input",{staticClass:"mt-3 mb-5 w-full",attrs:{placeholder:"А1","vs-placeholder":"А1"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save(e)}},model:{value:t.current.name,callback:function(e){t.$set(t.current,"name",e)},expression:"current.name"}}),i("span",[t._v("Введите ID модуля")]),i("vs-input",{staticClass:"mt-3 w-full",attrs:{placeholder:"201905040001","vs-placeholder":"201905040001"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save(e)}},model:{value:t.current.device_id,callback:function(e){t.$set(t.current,"device_id",e)},expression:"current.device_id"}})],1)])],1):t._e()},s=[],c=(i("7f7f"),i("96cf"),i("3b8d")),r={data:function(){return{section:null,isPrompt:!1,current:{id:null,name:"",device_id:"",section_id:""}}},created:function(){this.getList()},mounted:function(){var t=this;this.$io.on("model:update:modules",function(){t.getList()})},beforeDestroy:function(){var t=this;this.$io.on("model:update:modules",function(){t.getList()})},methods:{getList:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.get("/sections/"+this.$route.params.id);case 3:e=t.sent,this.section=e.data,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),404===t.t0.response.status?this.$router.push("/error-404"):this.$vs.dialog({type:"confirm",color:"warning",title:"Ошибка",text:"Не удалось получить данные, повторите попытку",accept:this.getList,acceptText:"Повторить",cancelText:"Отменить"});case 10:case"end":return t.stop()}},t,this,[[0,7]])}));function e(){return t.apply(this,arguments)}return e}(),open:function(t){this.$router.push("/sections/"+t)},edit:function(t){this.current={id:t.id,name:t.name,device_id:t.device_id,section_id:this.section.id},this.isPrompt=!0},remove:function(t){this.current={id:t.id,name:t.name,device_id:t.device_id,section_id:this.section.id},this.$vs.dialog({type:"confirm",color:"danger",title:"Подтвердите действие",text:"Внимание! Данное действие невозможно отменить!",accept:this.delete,cancel:this.cancel,acceptText:"Удалить",cancelText:"Отменить"})},cancel:function(){this.isPrompt=!1,this.current={id:null,name:"",device_id:"",section_id:""}},save:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.current.id){t.next=6;break}return t.next=4,this.$http.post("/modules/"+this.current.id,{name:this.current.name,device_id:this.current.device_id,section_id:this.section.id});case 4:t.next=8;break;case 6:return t.next=8,this.$http.post("/modules",{name:this.current.name,device_id:this.current.device_id,section_id:this.section.id});case 8:this.$vs.notify({color:"success",title:"Успешно",text:"Данные сохранены"}),this.cancel(),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),403===t.t0.response.status?(this.$vs.notify({color:"warning",title:"Ошибка",text:t.t0.response.data.message}),this.isPrompt=!0):this.$vs.dialog({type:"confirm",color:"warning",title:"Ошибка",text:"Не удалось сохранить данные, повторите попытку",accept:this.save,acceptText:"Повторить",cancelText:"Отменить"});case 15:case"end":return t.stop()}},t,this,[[0,12]])}));function e(){return t.apply(this,arguments)}return e}(),delete:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.delete("/modules/"+this.current.id);case 3:this.$vs.notify({color:"success",title:"Успешно",text:"Запись удалена"}),this.cancel(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$vs.dialog({type:"confirm",color:"warning",title:"Ошибка",text:"Не удалось сохранить данные, повторите попытку",accept:this.delete,acceptText:"Повторить",cancelText:"Отменить"});case 10:case"end":return t.stop()}},t,this,[[0,7]])}));function e(){return t.apply(this,arguments)}return e}()}},a=r,o=(i("b089"),i("2877")),l=Object(o["a"])(a,n,s,!1,null,null,null);e["default"]=l.exports},b089:function(t,e,i){"use strict";var n=i("b5f1"),s=i.n(n);s.a},b5f1:function(t,e,i){}}]);
//# sourceMappingURL=chunk-03c8d398.9cdf90ce.js.map